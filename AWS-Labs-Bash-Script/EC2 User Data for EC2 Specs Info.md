
# EC2 User Data for EC2 Specs Info: UserData Without Sytle 
```
#!/bin/bash
# Update the system
sudo yum update -y

# Install Apache HTTP Server
sudo yum install -y httpd

# Start and enable Apache
sudo systemctl start httpd
sudo systemctl enable httpd

# Use IMDSv2 to get metadata token
TOKEN=$(curl -X PUT "http://169.254.169.254/latest/api/token" -H "X-aws-ec2-metadata-token-ttl-seconds: 21600" -s)

# Get Private and Public IPs (using token)
PRIVATE_IP=$(curl -s -H "X-aws-ec2-metadata-token: $TOKEN" http://169.254.169.254/latest/meta-data/local-ipv4)
PUBLIC_IP=$(curl -s -H "X-aws-ec2-metadata-token: $TOKEN" http://169.254.169.254/latest/meta-data/public-ipv4)

# Get current date and time
CURRENT_DATE=$(date)

# Create simple web page
cat <<EOF > /var/www/html/index.html
<html>
  <head>
    <title>AWS Apache Web Server</title>
  </head>
  <body style="font-family: Arial; text-align: center; margin-top: 50px;">
    <h1>AWS Apache Web Server Status</h1>
    <p><strong>Private IP Address:</strong> $PRIVATE_IP</p>
    <p><strong>Public IP Address:</strong> $PUBLIC_IP</p>
    <p><strong>Current Date & Time:</strong> $CURRENT_DATE</p>
    <hr>
    <p style="color: gray;">Generated by EC2 user data script</p>
  </body>
</html>
EOF

```
 


# EC2 User Data for EC2 Specs Info 2: UserData Without Sytle 

```
#!/bin/bash
yum update -y
yum install -y httpd
echo "LoadModule rewrite_module modules/mod_rewrite.so" > /etc/httpd/conf.modules.d/00-rewrite.conf

# Overwrite the redirect.conf file with the CORRECT two-rule logic
cat > /etc/httpd/conf.d/redirect.conf <<EOF
<VirtualHost *:80>
    RewriteEngine On
    
    # 1. Handle ROOT request (e.g., http://ip/ )
    RewriteRule ^/$ https://d1wzxen0ufx0gn.cloudfront.net/index.html [R=301,L]
    
    # 2. Handle ALL OTHER requests (e.g., http://ip/about/ )
    # Note: The backslash before $1 is NOT needed inside the <<-EOF block
    RewriteRule ^(.*)$ https://d1wzxen0ufx0gn.cloudfront.net$1 [R=301,L]
    
</VirtualHost>
EOF
systemctl enable httpd
systemctl start httpd


sudo mount -t efs fs-0f5346f2fbcb781b3.efs.eu-north-1.amazonaws.com:/ /mnt/efs -o tls


#!/bin/bash
# Update and install required packages
yum update -y
yum install -y httpd awscli jq

# Start Apache
systemctl start httpd
systemctl enable httpd

# Metadata token
TOKEN=$(curl -X PUT "http://169.254.169.254/latest/api/token" \
  -H "X-aws-ec2-metadata-token-ttl-seconds: 21600" -s)

# Basic metadata
INSTANCE_ID=$(curl -s -H "X-aws-ec2-metadata-token: $TOKEN" \
  http://169.254.169.254/latest/meta-data/instance-id)
PRIVATE_IP=$(curl -s -H "X-aws-ec2-metadata-token: $TOKEN" \
  http://169.254.169.254/latest/meta-data/local-ipv4)
PUBLIC_IP=$(curl -s -H "X-aws-ec2-metadata-token: $TOKEN" \
  http://169.254.169.254/latest/meta-data/public-ipv4)
AZ=$(curl -s -H "X-aws-ec2-metadata-token: $TOKEN" \
  http://169.254.169.254/latest/meta-data/placement/availability-zone)
REGION=$(echo "$AZ" | sed 's/[a-z]$//')

# Wait for IAM role credentials
echo "Waiting for IAM role credentials..."
for i in {1..10}; do
  aws sts get-caller-identity --region "$REGION" >/tmp/awsid.json 2>/dev/null && break
  sleep 5
done

# Retrieve VPC ID
VPC_ID=$(aws ec2 describe-instances \
  --instance-ids "$INSTANCE_ID" \
  --region "$REGION" \
  --query "Reservations[0].Instances[0].VpcId" \
  --output text 2>/dev/null)

# Retrieve VPC Name tag (if any)
VPC_NAME=$(aws ec2 describe-vpcs \
  --vpc-ids "$VPC_ID" \
  --region "$REGION" \
  --query "Vpcs[0].Tags[?Key=='Name'].Value | [0]" \
  --output text 2>/dev/null)

# Handle missing info
if [ -z "$VPC_ID" ] || [ "$VPC_ID" == "None" ]; then
  VPC_ID="Unavailable"
fi
if [ -z "$VPC_NAME" ] || [ "$VPC_NAME" == "None" ]; then
  VPC_NAME="No Name Tag"
fi

# Current date and time
CURRENT_DATE=$(date)

# Create webpage
cat <<EOF > /var/www/html/index.html
<html>
  <head>
    <title>AWS Apache Web Server</title>
  </head>
  <body style="font-family: Arial; text-align: center; margin-top: 50px;">
    <h1>AWS Apache Web Server Status</h1>
    <p><strong>Instance ID:</strong> $INSTANCE_ID</p>
    <p><strong>Private IP Address:</strong> $PRIVATE_IP</p>
    <p><strong>Public IP Address:</strong> $PUBLIC_IP</p>
    <p><strong>Availability Zone:</strong> $AZ</p>
    <p><strong>Region:</strong> $REGION</p>
    <p><strong>VPC ID:</strong> $VPC_ID</p>
    <p><strong>VPC Name:</strong> $VPC_NAME</p>
    <p><strong>Current Date & Time:</strong> $CURRENT_DATE</p>
    <hr>
     <p style="color: gray;"><strong> Generated by EC2 user data script (Charlie)</strong></p>
  </body>
</html>
EOF
```

# EC2 User Data for EC2 Specs Info 2: UserData With Sytle 





```
#!/bin/bash
# --- Initial Setup ---
yum update -y
yum install -y httpd awscli jq

# Start and enable Apache
systemctl start httpd
systemctl enable httpd

# Wait for IAM role credentials (max 50 seconds)
echo "Waiting for IAM role credentials..."
for i in {1..10}; do
    aws sts get-caller-identity >/tmp/awsid.json 2>/dev/null && break
    sleep 5
done

# --- Fetch Metadata ---
TOKEN=$(curl -X PUT "http://169.254.169.254/latest/api/token" \
    -H "X-aws-ec2-metadata-token-ttl-seconds: 21600" -s)

# Helper function to fetch metadata
get_meta() {
    curl -s -H "X-aws-ec2-metadata-token: $TOKEN" "http://169.254.169.254/latest/meta-data/$1"
}

INSTANCE_ID=$(get_meta "instance-id")
PRIVATE_IP=$(get_meta "local-ipv4")
PUBLIC_IP=$(get_meta "public-ipv4")
AZ=$(get_meta "placement/availability-zone")
REGION=$(echo "$AZ" | sed 's/[a-z]$//')
CURRENT_DATE=$(date)

# --- Fetch EC2/VPC Info using AWS CLI ---
# Retrieve VPC ID (Requires IAM Role)
VPC_ID=$(aws ec2 describe-instances \
    --instance-ids "$INSTANCE_ID" \
    --region "$REGION" \
    --query "Reservations[0].Instances[0].VpcId" \
    --output text 2>/dev/null || echo "Unavailable")

# Retrieve VPC Name tag (Requires IAM Role)
VPC_NAME=$(aws ec2 describe-vpcs \
    --vpc-ids "$VPC_ID" \
    --region "$REGION" \
    --query "Vpcs[0].Tags[?Key=='Name'].Value | [0]" \
    --output text 2>/dev/null || echo "No Name Tag")

# --- Generate Styled Webpage ---
cat <<EOF > /var/www/html/index.html
<html>
<head>
    <title>EC2 Instance Info Dashboard</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f2f5;
            color: #333;
            margin: 0;
            padding: 20px;
            text-align: center;
        }
        .container {
            max-width: 900px;
            margin: 40px auto;
            background: #fff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #1a73e8; /* Google Blue */
            border-bottom: 3px solid #fbbc05; /* Google Yellow */
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        .category {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            margin-top: 20px;
        }
        .info-card {
            background-color: #e8f0fe; /* Light Google Blue */
            border: 1px solid #c8dafc;
            border-radius: 8px;
            padding: 15px;
            margin: 10px;
            width: 45%;
            text-align: left;
        }
        .info-card strong {
            display: block;
            color: #4285f4; /* Google Blue */
            font-size: 1.1em;
            margin-bottom: 5px;
        }
        .logo-placeholder {
            margin-bottom: 20px;
        }
        .logo-placeholder img {
            height: 30px;
            width: auto;
        }
        .footer {
            margin-top: 40px;
            padding-top: 15px;
            border-top: 1px solid #ccc;
            color: #777;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo-placeholder">
            <svg xmlns="http://www.w3.org/2000/svg" height="30px" viewBox="0 0 48 48" width="30px" fill="#4285F4"><path d="M44.5 20H24v8.5h11.8c-.8 5.7-5.9 10.3-11.8 10.3-6.5 0-11.8-5.3-11.8-11.8s5.3-11.8 11.8-11.8c3.3 0 6.2 1.4 8.3 3.5l6-6c-3.6-3.4-8.5-5.5-13.3-5.5C14.7 6.5 6 15.2 6 26s8.7 19.5 19.5 19.5 19.5-8.7 19.5-19.5c0-1.4-.2-2.8-.5-4.1z"/></svg>
        </div>
        <h1>AWS EC2 Instance Dashboard</h1>

        <h2>üåê Network & Location</h2>
        <div class="category">
            <div class="info-card"><strong>Region:</strong> $REGION</div>
            <div class="info-card"><strong>Availability Zone:</strong> $AZ</div>
            <div class="info-card"><strong>Private IP Address:</strong> $PRIVATE_IP</div>
            <div class="info-card"><strong>Public IP Address:</strong> $PUBLIC_IP</div>
        </div>
        
        <h2>üñ•Ô∏è Instance Details</h2>
        <div class="category">
            <div class="info-card"><strong>Instance ID:</strong> $INSTANCE_ID</div>
            <div class="info-card"><strong>Current Date & Time:</strong> $CURRENT_DATE</div>
        </div>

        <h2>‚òÅÔ∏è VPC Information</h2>
        <div class="category">
            <div class="info-card"><strong>VPC ID:</strong> $VPC_ID</div>
            <div class="info-card"><strong>VPC Name:</strong> $VPC_NAME</div>
        </div>

        <div class="footer">
            Generated by EC2 user data script (charlie).
        </div>
    </div>
</body>
</html>
EOF
```



